<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org" th:fragment="Layout(content)"
	xmlns:sec="http://www.thymeleaf.org/extras/spring-security6">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<meta name="_csrf" th:content="${_csrf.token}" />
	<meta name="_csrf_header" th:content="${_csrf.headerName}" />
	<title>BulkTradeHub</title>
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">
	<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.3/css/all.min.css">
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.12.1/font/bootstrap-icons.min.css">
	<script src="https://cdn.tailwindcss.com"></script>
	<style>
		footer {
			background-color: #343a40;
			color: #ffffff;
		}

		footer a {
			color: #ffffff;
		}

		footer a:hover {
			color: #f8f9fa;
		}
		html, body {
		    height: 100%;
		    margin: 0;
		    display: flex;
		    flex-direction: column;
		}

		main {
		    flex: 1;
		}
		
		@keyframes popCart {
		  0%   { transform: scale(1); }
		  30%  { transform: scale(2); }
		  100% { transform: scale(1); }
		}

		.cart-pop {
		  animation: popCart 0.3s ease-in-out;
		}


	</style>
</head>

<body>

	<!-- Navigation Bar -->
	<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
		<div class="container-fluid">
			<a class="navbar-brand" th:href="@{/home}"><i class="fas fa-shopping-cart"></i> BulkTradeHub</a>
			<ul class="navbar-nav">
				<li class="nav-item" sec:authorize="hasRole('RETAIL')">
					<a class="nav-link" th:href="@{/retailShop/dashboard}">Dashboard</a>
				</li>
				<li class="nav-item" sec:authorize="hasRole('BUSINESS')">
					<a class="nav-link" th:href="@{/business/dashboard}">Dashboard</a>
				</li>
				<li class="nav-item position-relative">
				  <a class="nav-link" style="font-size: 1.2rem;" th:href="@{/home/getCart}">
				    <i class="bi bi-cart-fill"></i>
				    <span id="cart-count" class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size: 0.6rem; display:none;">
				      0
				    </span>
				  </a>
				</li>
				<li class="nav-item" sec:authorize="isAnonymous()">
					<a class="nav-link" th:href="@{/login}">Login</a>
				</li>
				<li class="nav-item" sec:authorize="isAuthenticated()">
					<a class="nav-link" th:href="@{/logout}">Logout</a>
				</li>
				<li class="nav-item" sec:authorize="isAnonymous()">
					<a class="nav-link" th:href="@{/registration}">Sign Up</a>
				</li>
			</ul>
		</div>
	</nav>
	
	<!-- main -->
	<main>
		<div th:replace="${content}"></div>
	</main>

	<!-- main -->

	<!-- Footer -->
	<footer class="bg-dark text-center text-lg-start mt-5">
		<div class="container p-4 mt-5">
			<div class="row">
				<div class="col-lg-4 col-md-12 mb-4">
					<h5 class="text-uppercase">Contact Us</h5>
					<p>Email: support@bulktradehub.com</p>
					<p>Phone: +1 234 567 890</p>
				</div>
				<div class="col-lg-4 col-md-12 mb-4">
					<h5 class="text-uppercase">Links</h5>
					<ul class="list-unstyled">
						<li><a href="#">Privacy Policy</a></li>
						<li><a href="#">Terms of Service</a></li>
					</ul>
				</div>
				<div class="col-lg-4 col-md-12 mb-4">
					<h5 class="text-uppercase">Follow Us</h5>
					<a href="#" class="fab fa-facebook-f"></a> <a href="#" class="fab fa-twitter"></a> <a href="#"
						class="fab fa-instagram"></a>
				</div>
			</div>
		</div>
	</footer>


	<script src="https://code.jquery.com/jquery-3.5.1.slim.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.9.2/dist/umd/popper.min.js"></script>
	<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
	<script>
		function updateCartCount() {
		  const cart = JSON.parse(localStorage.getItem('guestCart')) || [];
		  const totalCount = cart.length;

		  const countSpan = document.getElementById('cart-count');

		  if (totalCount === 0) {
		    countSpan.style.display = 'none';
		  } else {
		    countSpan.style.display = 'inline-block';
			if (countSpan.textContent !== totalCount.toString()) {
		      countSpan.textContent = totalCount;

		      // Trigger animation
		      countSpan.classList.remove('cart-pop');
		      void countSpan.offsetWidth;
		      countSpan.classList.add('cart-pop');
		    }
		  }
		}

		updateCartCount();
		
	</script>
</body>

</html>